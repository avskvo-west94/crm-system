# Инструкция по созданию установщика для Windows 10
# =============================================================================

## Обзор

Этот проект можно упаковать в установщик для Windows 10, который включает все необходимые компоненты и не требует дополнительных загрузок во время установки.

## Структура файлов для Windows

```
windows/
├── install.bat          # Простой установщик (Batch)
├── install.ps1         # Продвинутый установщик (PowerShell)
├── installer.nsi       # Скрипт для NSIS (полноценный установщик)
├── start_sup.bat       # Скрипт запуска
├── stop_sup.bat        # Скрипт остановки
└── restart_sup.bat     # Скрипт перезапуска
```

## Варианты установки

### Вариант 1: Простой установщик (install.bat)

**Требования:**
- Windows 10
- Права администратора
- Docker Desktop Installer.exe (нужно скачать отдельно)

**Использование:**
1. Скопируйте папку `windows` и файлы проекта в одну директорию
2. Поместите `Docker Desktop Installer.exe` в ту же директорию
3. Запустите `install.bat` от имени администратора

**Преимущества:**
- Простой в использовании
- Не требует дополнительного ПО
- Быстрая установка

**Недостатки:**
- Требует ручного скачивания Docker Desktop
- Нет графического интерфейса

### Вариант 2: PowerShell установщик (install.ps1)

**Требования:**
- Windows 10
- PowerShell 5.1+
- Права администратора
- Docker Desktop Installer.exe (опционально)

**Использование:**
```powershell
# Обычная установка
powershell -ExecutionPolicy Bypass -File install.ps1

# Тихая установка
powershell -ExecutionPolicy Bypass -File install.ps1 -Silent
```

**Преимущества:**
- Более продвинутая логика
- Лучшая обработка ошибок
- Поддержка тихой установки

### Вариант 3: NSIS установщик (installer.nsi)

**Требования:**
- NSIS (Nullsoft Scriptable Install System) - бесплатный установщик
- Скачать с: https://nsis.sourceforge.io/Download

**Создание установщика:**

1. Установите NSIS
2. Откройте файл `installer.nsi` в NSIS
3. Нажмите "Compile" (F9) для создания установщика
4. Или используйте командную строку:
   ```cmd
   "C:\Program Files (x86)\NSIS\makensis.exe" installer.nsi
   ```

**Результат:**
- Создается файл `SUP_System_Setup.exe`
- Полноценный установщик с графическим интерфейсом
- Поддержка деинсталляции
- Создание ярлыков и записей в меню Пуск

**Преимущества:**
- Профессиональный вид
- Полный контроль над процессом установки
- Автоматическая деинсталляция
- Поддержка лицензий и пользовательских сообщений

## Подготовка файлов для установщика

### Шаг 1: Сборка проекта

```bash
# На Linux сервере или в WSL
cd /home/user/crm-system

# Создание архива проекта
tar czf sup_project.tar.gz \
    backend/ \
    frontend/ \
    nginx/ \
    docker-compose.yml \
    .env.example \
    windows/
```

### Шаг 2: Подготовка для Windows

1. Распакуйте архив на Windows машине
2. Скачайте Docker Desktop Installer:
   - Перейдите на https://www.docker.com/products/docker-desktop/
   - Скачайте `Docker Desktop Installer.exe`
   - Поместите в папку с файлами проекта

### Шаг 3: Настройка для Windows

**Важные изменения для Windows:**

1. **docker-compose.yml:**
   - Замените IP адреса на `localhost`
   - Проверьте пути к файлам

2. **.env файл:**
   - `VITE_API_URL=http://localhost:8000`
   - `BACKEND_CORS_ORIGINS=["http://localhost","http://localhost:3000"]`

3. **Порты:**
   - Убедитесь, что порты 80, 443, 3000, 8000 не заняты

## Создание финального установщика

### Метод 1: Использование NSIS (рекомендуется)

1. Установите NSIS
2. Откройте `windows/installer.nsi` в редакторе NSIS
3. Настройте пути к файлам проекта
4. Скомпилируйте установщик

### Метод 2: Использование Inno Setup (альтернатива)

Inno Setup - еще один популярный установщик для Windows.

1. Скачайте Inno Setup: https://jrsoftware.org/isdl.php
2. Создайте новый проект установщика
3. Укажите файлы проекта
4. Настройте скрипты установки Docker Desktop
5. Скомпилируйте установщик

## Что включает установщик

1. **Все файлы проекта:**
   - Backend (Python/FastAPI)
   - Frontend (React)
   - Nginx конфигурация
   - Docker Compose файл

2. **Docker Desktop:**
   - Автоматическая установка (если включено)
   - Настройка и запуск

3. **Скрипты управления:**
   - `start_sup.bat` - запуск системы
   - `stop_sup.bat` - остановка системы
   - `restart_sup.bat` - перезапуск системы

4. **Ярлыки:**
   - На рабочем столе
   - В меню Пуск

5. **Автозапуск:**
   - Опциональная настройка автозапуска при загрузке Windows

## Размер установщика

- **Без Docker Desktop:** ~50-100 МБ
- **С Docker Desktop:** ~500-600 МБ (Docker Desktop ~400 МБ)

## Использование после установки

После установки пользователь может:

1. Запустить систему через ярлык на рабочем столе
2. Открыть браузер: http://localhost
3. Войти в систему с учетными данными администратора

## Решение проблем

### Docker Desktop не запускается

- Убедитесь, что включена виртуализация в BIOS
- Проверьте, что WSL 2 установлен
- Перезагрузите компьютер после установки Docker Desktop

### Порты заняты

Измените порты в `docker-compose.yml`:
```yaml
ports:
  - "8080:80"  # Вместо 80
  - "3043:443" # Вместо 443
```

### Проблемы с правами

Запускайте скрипты от имени администратора.

## Альтернативные варианты

### Вариант А: Портативная версия

Создать архив с проектом и инструкцией по установке Docker Desktop вручную.

### Вариант Б: Установка через Chocolatey

Создать пакет Chocolatey для автоматической установки всех компонентов.

### Вариант В: Нативная Windows версия

Переписать проект на нативные технологии Windows (WPF/WinForms), но это потребует полной переработки проекта.

## Рекомендации

1. **Для большинства пользователей:** Используйте NSIS установщик - он самый простой и профессиональный
2. **Для быстрой установки:** Используйте install.bat или install.ps1
3. **Для корпоративного использования:** Рассмотрите создание MSI пакета через WiX Toolset

## Дополнительные ресурсы

- NSIS документация: https://nsis.sourceforge.io/Docs/
- Docker Desktop для Windows: https://www.docker.com/products/docker-desktop/
- Inno Setup: https://jrsoftware.org/isinfo.php

